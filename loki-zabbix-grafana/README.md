# Loki + Zabbix + Grafana. Отчет по лабораторной работе

## Часть 1. Логирование

Запускаем файл docker-compose.yml

![Скрин терминала](images/img1.png)

Инициализируем Nextcloud

![Создание учетной записи](images/img2.png)

![Проверка логов](images/img3.png)

![Логи promtail](images/img4.png)

## Часть 2. Мониторинг

Настраиваем Zabbix и имортируем кастомный шаблон

![Вход в учетную запись Zabbix](images/img5.png)

![Импорт шаблона](images/img7.png)

В разделе Data collection → Hosts создаем хост. Указываем адрес контейнера nextcloud, хост группа - Applications. В поле Templates выбираем добавленный на шаге 2 Templates/Applications→ Test ping template


![Создание хоста](images/img9.png)

Переходим в раздел Monitoring → Latest data, где можно увидеть первые данные. В нашем случае значение healthy

![Мониторинг](images/img10.png)

Временно включаем в Nextcloud maintenance mode, проверяем что сработал триггер, выключаем режим обратно и убеждаемся, что
проблема помечена как “решенная”

![Появление проблемы](images/img11.png)

![Проблема решена](images/img12.png)

## Часть 3. Визуализация

![Grafana](images/img14.png)

Подключаем Loki к Grafana, раздел Connections → Data sources → Loki. В настройках подключения указываем имя и адрес http://loki:3100. Сохраняем подключение


![Подключение Loki](images/img15.png)
Так же подключаем Zabbix: снова добавляем новый датасурс, в качестве URL указываем http://zabbix-frontend:8082/api_jsonrpc.php, заполняем Username и Password, через Save & test проверяем, что подключение успешно

![Подключение Zabbix](images/img16.png)

Переходим в Explore, выбираем в качестве селектора job либо filename. Затем нажимпем Run query и видим логи

![Логи](images/img17.png)

![Фильтры в Zabbix](images/img18.png)

## Задание 1. Запросы

![Простое отображение логов](images/img19.png)

![Логи, содержащие ошибки](images/img20.png)

![Подсчет логов за 24 часа, содержащих warning (таких нет)](images/img21.png)

![Мониторинг состояния](images/img22.png)

## Задание 2. Дашборды

![Дашборд 1](images/img23.png)

![Дашборд 2](images/img24.png)

## Ответы на вопросы

1. *Чем SLO отличается от SLA?*

**SLO (Service Level Objective):**

- Это конкретные цели, которые устанавливаются для ключевых показателей эффективности работы сервиса, таких как доступность или время отклика.

- SLO описывает уровень сервиса, которого провайдер стремится достичь, например, 99.9% доступности.

- Используется как внутренний инструмент для управления качеством сервиса и мониторинга его эффективности.

**SLA (Service Level Agreement):**

- Это формальный договор между заказчиком и поставщиком услуги, в котором описаны условия предоставления услуги, включая права, обязанности и уровень качества сервиса.

- SLA включает конкретные SLO, которые заказчик и поставщик согласовывают как обязательные для выполнения.

- Если SLA нарушается (например, уровень сервиса ниже оговоренного), это может повлечь за собой штрафные санкции или компенсации для заказчика.

SLO — это техническая цель внутри сервиса, а SLA — это юридически оформленное соглашение о качестве предоставления услуги между сторонами.

2. *Чем отличается инкрементальный бэкап от дифференциального?*

**Инкрементальный бэкап** — это резервное копирование, которое сохраняет только те данные, которые изменились **с момента последнего бэкапа** (не важно, был ли он полным или инкрементальным). То есть, если после полного бэкапа были сделаны несколько инкрементальных, каждый новый инкрементальный бэкап содержит изменения, произошедшие после предыдущего бэкапа.

**Преимущество:** меньшее количество данных для копирования, быстрее выполняется.

**Недостаток:** для восстановления данных нужно восстанавливать последовательно все копии (полный + все инкрементальные).

**Дифференциальный бэкап** — это резервное копирование, которое сохраняет все изменения, произошедшие **с момента последнего полного бэкапа**. Таким образом, каждый последующий дифференциальный бэкап включает в себя изменения, накопленные с момента полного бэкапа, независимо от того, сколько времени прошло и сколько бэкапов было сделано до этого.

**Преимущество:** процесс восстановления проще и быстрее, чем в случае инкрементального.

**Недостаток:** размер дифференциальной копии увеличивается с каждым днем после полного бэкапа, так как сохраняются все изменения с момента последнего полного резервного копирования.

**Основное различие:**

- Инкрементальный: копирует изменения после последнего любого бэкапа.

- Дифференциальный: копирует изменения только после последнего полного бэкапа.

3. *В чем разница между мониторингом и observability?*

**Мониторинг:**

Мониторинг — это процесс сбора, анализа и отображения данных о работе системы с использованием заранее определенных метрик и предупреждений. В рамках мониторинга администраторы и инженеры наблюдают за тем, что **уже известно** о системе. Обычно мониторинг настроен для отслеживания конкретных показателей, таких как:

- Загруженность CPU

- Использование памяти

- Время отклика приложения

- Доступность сервисов

Мониторинг направлен на **реактивное** поведение: отслеживание заранее известных проблем или сбоев в системе, чтобы своевременно реагировать на инциденты.

**Observability:**

Observability — это более широкий и **проактивный** подход, который позволяет глубже понять состояние системы, исходя из ее внутренних сигналов. Это концепция, которая помогает отвечать на вопрос: **почему** система ведёт себя определённым образом. **Observability** включает три ключевых компонента:

- Логи — записи о событиях в системе.

- Метрики — числовые данные, которые можно агрегировать и анализировать.

- Трейсы — детализированные следы выполнения операций, которые помогают понять, как отдельные запросы проходят через систему.

**Observability** позволяет инженерам исследовать поведение системы, даже когда проблема еще не определена. Она делает акцент на возможности **задавать новые вопросы**, когда происходят неизвестные сбои или аномалии.

**Основное различие:**

- **Мониторинг** фокусируется на **заранее определенных метриках** и предупреждениях для отслеживания известных проблем.

- **Observability** предоставляет **глубокое понимание** системы для поиска причин неизвестных сбоев, помогая диагностировать новые, неочевидные проблемы.
