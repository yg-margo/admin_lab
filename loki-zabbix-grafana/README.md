# Loki + Zabbix + Grafana. Отчет по лабораторной работе

## Часть 1. Логирование

Запускаем файл docker-compose.yml

![Скрин терминала](images/img1.png)

Инициализируем Nextcloud

![Создание учетной записи](images/img2.png)

![Проверка логов](images/img3.png)

## Часть 2. Мониторинг

1. Подключились к Zabbix и импортировали кастомный шаблон для мониторинга nextcloud.
2. Командами `docker exec -u www-data -it nextcloud bash` и `php occ config:system:set trusted_domains 1 --value="nextcloud"` разрешаем zabbix подключаться к nexcloud
3. В _Data collection → Hosts_ создали хост для Nextcloud и подключили шаблон мониторинга.
4. Проверили в _Monitoring → Latest data_ — данные успешно поступают (значение `healthy`).
	![](img/img4.png)
5. Проверили работу триггеров, включив в nextcloud maintenance mode командой `php occ maintenance:mode --on`. После чего зафиксировали проблему в разделе Monitoring → Problems, связанную с режимом обслуживания Nextcloud. Отключаем maintenance mode командой `php occ maintenance:mode --off` и проблема становится решенной

## Часть 3. Визуализация

1. Установили плагин Zabbix для Grafana командой `docker exec -it grafana bash -c "grafana cli plugins install alexanderzobnin-zabbix-app"`, после чего перезапустили контейнер Grafana с помощью команды `docker restart grafana`.
2. После перезапуска вошли в Grafana и в разделе `Administration → Plugins` активировали плагин Zabbix.
3. Подключили Loki и Zabbix к Grafana. 
4. В Explore, выбрали в качестве селектора индекс job, как результат мы увидели логи, подтверждая корректную настройку.
	![](img/img5.png)
1. То же самое было проделано с Zabbix.
	![](img/img6.png)

## Создание дашбордов
![](img/img7.png)


## Ответы на вопросы

1. *Чем SLO отличается от SLA?*

**SLO (Service Level Objective):**

- Это конкретные цели, которые устанавливаются для ключевых показателей эффективности работы сервиса, таких как доступность или время отклика.

- SLO описывает уровень сервиса, которого провайдер стремится достичь, например, 99.9% доступности.

- Используется как внутренний инструмент для управления качеством сервиса и мониторинга его эффективности.

**SLA (Service Level Agreement):**

- Это формальный договор между заказчиком и поставщиком услуги, в котором описаны условия предоставления услуги, включая права, обязанности и уровень качества сервиса.

- SLA включает конкретные SLO, которые заказчик и поставщик согласовывают как обязательные для выполнения.

- Если SLA нарушается (например, уровень сервиса ниже оговоренного), это может повлечь за собой штрафные санкции или компенсации для заказчика.

SLO — это техническая цель внутри сервиса, а SLA — это юридически оформленное соглашение о качестве предоставления услуги между сторонами.

2. *Чем отличается инкрементальный бэкап от дифференциального?*

**Инкрементальный бэкап** — это резервное копирование, которое сохраняет только те данные, которые изменились **с момента последнего бэкапа** (не важно, был ли он полным или инкрементальным). То есть, если после полного бэкапа были сделаны несколько инкрементальных, каждый новый инкрементальный бэкап содержит изменения, произошедшие после предыдущего бэкапа.

**Преимущество:** меньшее количество данных для копирования, быстрее выполняется.

**Недостаток:** для восстановления данных нужно восстанавливать последовательно все копии (полный + все инкрементальные).

**Дифференциальный бэкап** — это резервное копирование, которое сохраняет все изменения, произошедшие **с момента последнего полного бэкапа**. Таким образом, каждый последующий дифференциальный бэкап включает в себя изменения, накопленные с момента полного бэкапа, независимо от того, сколько времени прошло и сколько бэкапов было сделано до этого.

**Преимущество:** процесс восстановления проще и быстрее, чем в случае инкрементального.

**Недостаток:** размер дифференциальной копии увеличивается с каждым днем после полного бэкапа, так как сохраняются все изменения с момента последнего полного резервного копирования.

**Основное различие:**

- Инкрементальный: копирует изменения после последнего любого бэкапа.

- Дифференциальный: копирует изменения только после последнего полного бэкапа.

3. *В чем разница между мониторингом и observability?*

**Мониторинг:**

Мониторинг — это процесс сбора, анализа и отображения данных о работе системы с использованием заранее определенных метрик и предупреждений. В рамках мониторинга администраторы и инженеры наблюдают за тем, что **уже известно** о системе. Обычно мониторинг настроен для отслеживания конкретных показателей, таких как:

- Загруженность CPU

- Использование памяти

- Время отклика приложения

- Доступность сервисов

Мониторинг направлен на **реактивное** поведение: отслеживание заранее известных проблем или сбоев в системе, чтобы своевременно реагировать на инциденты.

**Observability:**

Observability — это более широкий и **проактивный** подход, который позволяет глубже понять состояние системы, исходя из ее внутренних сигналов. Это концепция, которая помогает отвечать на вопрос: **почему** система ведёт себя определённым образом. **Observability** включает три ключевых компонента:

- Логи — записи о событиях в системе.

- Метрики — числовые данные, которые можно агрегировать и анализировать.

- Трейсы — детализированные следы выполнения операций, которые помогают понять, как отдельные запросы проходят через систему.

**Observability** позволяет инженерам исследовать поведение системы, даже когда проблема еще не определена. Она делает акцент на возможности **задавать новые вопросы**, когда происходят неизвестные сбои или аномалии.

**Основное различие:**

- **Мониторинг** фокусируется на **заранее определенных метриках** и предупреждениях для отслеживания известных проблем.

- **Observability** предоставляет **глубокое понимание** системы для поиска причин неизвестных сбоев, помогая диагностировать новые, неочевидные проблемы.
